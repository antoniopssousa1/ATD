%% 1 a)
clear
b0 = 3;
b1 = -4;

b = [b0,b1];
a = [1, -4/5, 16/25];

N = 200; k = -N/2:N/2; w = k*2*pi/N;
H = (b0+b1*exp(-1j*w))./(1-4/5*exp(-1j*w)+16/25*exp(-2j*w));


figure(1); plot(w/pi,abs(H));                                                            
figure(2); plot(w/pi,angle(H)/pi);
%% 1 b)

w0 = 0.2*pi;
n = 0:100;
x = cos(w0*n);
y = filter(b,a,x);
figure(3); plot(n,x,n,y)

%% 1 c)

H0 = (b0+b1*exp(-1j*w0))./(1-4/5*exp(-1j*w0)+16/25*exp(-2j*w0));
A = abs(H0);
phi = angle(H0);
phi/pi
n0 = phi/w0

%% 2a)

num = [3,-4];
den = [1,-4/5, 16/25];
N = 1024;
k = 0:N-1; w = k*2*pi/N;
H = fft(num,N)./fft(den,N);
plot(w/pi, abs(H));
%% 2b)
plot(w(1:N/2+1)/pi, abs(H(1:N/2+1)))
%% 2c)

H2 = freqz(num, den);
size(H2)
plot(abs(H2))
%% 2d)
freqz(num, den)
%% 2e)
n = 0:99;
h = impz(num,den,100);
plot(n,h)
h(1:8)
%%
N = 8;
H100 = fft(num,N)./fft(den,N);
ha = ifft(H100);
%% quiz 1 

num = [1,2,3];
den = [1,-1/2, 8/9];
N = 32768;
k = 0:N-1; w = k*2*pi/N;
H = fft(num,N)./fft(den,N);
plot(w/pi, abs(H));
%% quiz 2

H5 = freqz(num, den);
size(H5)
plot(abs(H5))

%%
freqz(num, den)
%%
b0 = 1;
b1 = 2;
b2 = 3;


b = [b0,b1,b2];
a = [1, -1/2, 8/9];

N = 3; k = 0:2; w = k*2*pi/N;
H = (b0+b1*exp(-1j*w)+b2*exp(-2j*w))./(1-1/2*exp(-1j*w)+8/9*exp(-2j*w));


figure(1); plot(w/pi,abs(H));                                                            
figure(2); plot(w/pi,angle(H)/pi);



























































































































































































































































































































































































































































































































































































































































































































